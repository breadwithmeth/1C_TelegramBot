
Функция отправитьСообщениеТГ(Подписчик, Текст) Экспорт
	получитьТокен.получитьТокен();
	ТокенКонстанта1 = Константы.Токен.Получить();
	//Сообщить(ТокенКонстанта1);
	ЗаписьJSON = Новый ЗаписьJSON;
	ПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON.Нет, " ", Истина); 
	ЗаписьJSON.УстановитьСтроку();
	Сообщение = Новый Структура;
	Сообщение.Вставить("chat_id", Подписчик);
	Сообщение.Вставить("text", Текст);  
    ЗаписьJSON.УстановитьСтроку(ПараметрыJSON); 
	ЗаписатьJSON(ЗаписьJSON, Сообщение);
	ЗаписьJSON = ЗаписьJSON.Закрыть();
	
	
	url = "api.telegram.org";
    // Подключаемся к сайту.
    Соединение = Новый HTTPСоединение(
        url, // сервер (хост)
        , // порт, по умолчанию для http используется 80, для https 443
        , // пользователь для доступа к серверу (если он есть)
        , // пароль для доступа к серверу (если он есть)
        , // здесь указывается прокси, если он есть
        5, // таймаут в секундах, 0 или пусто - не устанавливать
        Новый ЗащищенноеСоединениеOpenSSL  // защищенное соединение, если используется https
    );
	
	
    // Получаем текст корневой страницы через GET-запрос.
	Запрос = Новый HTTPЗапрос("/bot"+ТокенКонстанта1+"/sendMessage");
	Запрос.Заголовки.Вставить("Content-type", "application/json");
	Запрос.УстановитьТелоИзСтроки(ЗаписьJSON, "UTF-8", ИспользованиеByteOrderMark.НеИспользовать);
	//Ответ = Соединение.Получить(Запрос);
	Соединение.ОтправитьДляОбработки(Запрос);

	
КонецФункции




#################################################################################################






Функция отправитьКнопкуТГ(Подписчик, Текст) Экспорт
	получитьТокен.получитьТокен();
	ТокенКонстанта1 = Константы.Токен.Получить();
	//Сообщить(ТокенКонстанта1);
	
	Сообщение = Новый Структура;
	Сообщение.Вставить("chat_id", Подписчик);
	Сообщение.Вставить("text", Текст);
	СтруктураКнопка = Новый Структура;
	МассивКнопка = Новый Массив;
	МассивКнопка2 = Новый Массив;
	СодержаниеКнопка = Новый Структура;
	СодержаниеКнопка.Вставить("text", "Отправить контакт");
	СодержаниеКнопка.Вставить("request_contact", True);
	МассивКнопка.Добавить(СодержаниеКнопка);
	МассивКнопка2.Добавить(МассивКнопка);
	СтруктураКнопка.Вставить("keyboard", МассивКнопка2);
	СтруктураКнопка.Вставить("one_time_keyboard", True);
	Сообщение.Вставить("reply_markup", СтруктураКнопка);
	
	ЗаписьJSON = Новый ЗаписьJSON;
	ПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON.Нет, " ", Истина); 
	ЗаписьJSON.УстановитьСтроку(ПараметрыJSON); 
	ЗаписатьJSON(ЗаписьJSON, Сообщение);
	ЗаписьJSON = ЗаписьJSON.Закрыть();     
	
	
	url = "api.telegram.org";
    // Подключаемся к сайту.
    Соединение = Новый HTTPСоединение(
        url, // сервер (хост)
        , // порт, по умолчанию для http используется 80, для https 443
        , // пользователь для доступа к серверу (если он есть)
        , // пароль для доступа к серверу (если он есть)
        , // здесь указывается прокси, если он есть
        5, // таймаут в секундах, 0 или пусто - не устанавливать
        Новый ЗащищенноеСоединениеOpenSSL  // защищенное соединение, если используется https
    );
	
	
    // Получаем текст корневой страницы через GET-запрос.
	Запрос = Новый HTTPЗапрос("/bot"+ТокенКонстанта1+"/sendMessage");
	Запрос.Заголовки.Вставить("Content-type", "application/json");
	Запрос.УстановитьТелоИзСтроки(ЗаписьJSON, "UTF-8", ИспользованиеByteOrderMark.НеИспользовать);
	//Ответ = Соединение.Получить(Запрос);
	Соединение.ОтправитьДляОбработки(Запрос);

	
КонецФункции








############################################################








Функция отправитьКнопкуСообщениемТГ(Подписчик, Текст) Экспорт
	получитьТокен.получитьТокен();
	ТокенКонстанта1 = Константы.Токен.Получить();
	//Сообщить(ТокенКонстанта1);
	
	Сообщение = Новый Структура;
	Сообщение.Вставить("chat_id", Подписчик);
	Сообщение.Вставить("text", Текст);
	СтруктураКнопка = Новый Структура;
	МассивКнопка = Новый Массив;
	МассивКнопка2 = Новый Массив;
	СодержаниеКнопка = Новый Структура;
	СодержаниеКнопка.Вставить("text", "Отправить контакт");
	СодержаниеКнопка.Вставить("url", "google.com");
	МассивКнопка.Добавить(СодержаниеКнопка);
	МассивКнопка2.Добавить(МассивКнопка);
	СтруктураКнопка.Вставить("inline_keyboard", МассивКнопка2);
	//СтруктураКнопка.Вставить("one_time_keyboard", True);
	Сообщение.Вставить("reply_markup", СтруктураКнопка);
	
	ЗаписьJSON = Новый ЗаписьJSON;
	ПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON.Нет, " ", Истина); 
	ЗаписьJSON.УстановитьСтроку(ПараметрыJSON); 
	ЗаписатьJSON(ЗаписьJSON, Сообщение);
	ЗаписьJSON = ЗаписьJSON.Закрыть();     
	
	
	url = "api.telegram.org";
    // Подключаемся к сайту.
    Соединение = Новый HTTPСоединение(
        url, // сервер (хост)
        , // порт, по умолчанию для http используется 80, для https 443
        , // пользователь для доступа к серверу (если он есть)
        , // пароль для доступа к серверу (если он есть)
        , // здесь указывается прокси, если он есть
        5, // таймаут в секундах, 0 или пусто - не устанавливать
        Новый ЗащищенноеСоединениеOpenSSL  // защищенное соединение, если используется https
    );
	
	
    // Получаем текст корневой страницы через GET-запрос.
	Запрос = Новый HTTPЗапрос("/bot"+ТокенКонстанта1+"/sendMessage");
	Запрос.Заголовки.Вставить("Content-type", "application/json");
	Запрос.УстановитьТелоИзСтроки(ЗаписьJSON, "UTF-8", ИспользованиеByteOrderMark.НеИспользовать);
	//Ответ = Соединение.Получить(Запрос);
	Соединение.ОтправитьДляОбработки(Запрос);

	
КонецФункции




########################################




Функция отправитьФотографию(Подписчик, ссылкаНаФото) Экспорт
	получитьТокен.получитьТокен();
	ТокенКонстанта1 = Константы.Токен.Получить();
	//Сообщить(ТокенКонстанта1);
	ЗаписьJSON = Новый ЗаписьJSON;
	ПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON.Нет, " ", Истина); 
	ЗаписьJSON.УстановитьСтроку();
	Сообщение = Новый Структура;
	Сообщение.Вставить("chat_id", Подписчик);
	Сообщение.Вставить("photo", ссылкаНаФото);  
    ЗаписьJSON.УстановитьСтроку(ПараметрыJSON); 
	ЗаписатьJSON(ЗаписьJSON, Сообщение);
	ЗаписьJSON = ЗаписьJSON.Закрыть();
	
	
	url = "api.telegram.org";
    // Подключаемся к сайту.
    Соединение = Новый HTTPСоединение(
        url, // сервер (хост)
        , // порт, по умолчанию для http используется 80, для https 443
        , // пользователь для доступа к серверу (если он есть)
        , // пароль для доступа к серверу (если он есть)
        , // здесь указывается прокси, если он есть
        5, // таймаут в секундах, 0 или пусто - не устанавливать
        Новый ЗащищенноеСоединениеOpenSSL  // защищенное соединение, если используется https
    );
	
	
    // Получаем текст корневой страницы через GET-запрос.
	Запрос = Новый HTTPЗапрос("/bot"+ТокенКонстанта1+"/sendPhoto");
	Запрос.Заголовки.Вставить("Content-type", "application/json");
	Запрос.УстановитьТелоИзСтроки(ЗаписьJSON, "UTF-8", ИспользованиеByteOrderMark.НеИспользовать);
	//Ответ = Соединение.Получить(Запрос);
	Соединение.ОтправитьДляОбработки(Запрос);
	
	
	
	
	
КонецФункции
